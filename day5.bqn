s â† â€¢Import "strings.bqn"

ex â† â€¢file.Chars "input/ex5.in"
in â† â€¢file.Chars "input/5.in"

lf â† @+10
SplitAtDoubleLineFeed â† lfâ€¿lfâŠ¸s.Split


input â† ex
chunks â† SplitAtDoubleLineFeed input

seeds â† 1â†‘ chunks
maps â† â€¢ParseFloatÂ¨Â¨Â¨ ' 'âŠ¸s.SplitÂ¨Â¨ 1âŠ¸â†“Â¨ lfâŠ¸s.SplitÂ¨ 1â†“ chunks

map1 â† âŠ‘ maps
m1 â† âŠ‘ map1

ParseMapping â† {ğ•Š âŸ¨dest, source, rangeâŸ©: source - dest}
ParseMapping m1

ApplyMapping â† { ğ•¨ğ•Šğ•©:
    âŸ¨dest, source, rangeâŸ© â† ğ•¨
    delta â† source - dest
    K â† {(âŠ‘ ğ•© âˆŠ source + â†•range) âŠ‘ âŸ¨0, Â¯1 Ã— deltaâŸ©}
    ğ•© + KÂ¨ ğ•©
}

GetMapping â† {ğ•Šğ•©:
    âŸ¨dest, source, rangeâŸ© â† ğ•©
    delta â† source - dest
    K â† {(âŠ‘ ğ•© âˆŠ source + â†•range) âŠ‘ âŸ¨0, Â¯1 Ã— deltaâŸ©}
}

âŸ¨dest, source, rangeâŸ© â† m1
delta â† source - dest

K â† {(âŠ‘ ğ•© âˆŠ source + â†•range) âŠ‘ âŸ¨0, Â¯1 Ã— deltaâŸ©}

(â†•100) ApplyMappingÂ´ âŠ‘ maps

borders â† âˆ§ â· âˆ¾(+`Â¨ âˆ¾1â†“Â¨Â¨maps)

â‰  borders

map1 


GetCheck â† { ğ•¨ğ•Šğ•©:
    aâ€¿bâ€¿c â† ğ•©
    â€¢Show ğ•©â€¿ğ•¨
    (b â‰¤ ğ•¨) âˆ§ (ğ•¨ < (b + c))
}

Transform â† { ğ•¨ğ•Šğ•©:
    aâ€¿bâ€¿c â† ğ•©
    ğ•¨ + (a-b)
}

2 GetCheck m1
99 Transform m1

Yâ†GetCheckâŸœm1â—¶âŸ¨âŠ£, TransformâŸœm1âŸ©

MakeCheckAndMap â† {GetCheckâŸœğ•©â—¶âŸ¨âŠ£, TransformâŸœğ•©âŸ©}

TransformForMap â† {MakeCheckAndMapÂ´ ğ•©}

funs â† TransformForMapÂ¨ maps