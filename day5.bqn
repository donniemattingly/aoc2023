s â† â€¢Import "strings.bqn"

ex â† â€¢file.Chars "input/ex5.in"
in â† â€¢file.Chars "input/5.in"

lf â† @+10

input â† ex
chunks â† lfâ€¿lfâŠ¸s.Split input

seeds â† â€¢ParseFloatÂ¨ " " s.Split 7â†“ âŠ‘ 1â†‘ chunks
ranges â† â¥Š â‹ˆË˜ âˆ˜â€¿2â¥Šseeds
borders â† âˆ§ â· âˆ¾(+`Â¨ âˆ¾1â†“Â¨Â¨maps)
maps â† â€¢ParseFloatÂ¨Â¨Â¨ ' 'âŠ¸s.SplitÂ¨Â¨ 1âŠ¸â†“Â¨ lfâŠ¸s.SplitÂ¨ 1â†“ chunks

GetCheck â† { ğ•¨ğ•Šğ•©:
    aâ€¿bâ€¿c â† ğ•©
    (b â‰¤ ğ•¨) âˆ§ (ğ•¨ < (b + c))
}

Transform â† { ğ•¨ğ•Šğ•©:
    aâ€¿bâ€¿c â† ğ•©
    ğ•¨ + (a-b)
}

M2 â† {âŸ¨TransformâŸœğ•©, GetCheckâŸœğ•©âŸ©}
MapFn â† { ğ•Šğ•©:
    checks â† 1âŠ¸âŠ‘Â¨ M2Â¨ ğ•©
    transforms â† âŠ‘Â¨ M2Â¨ ğ•©
    R â† {âŠ‘ ({ğ•© {ğ•ğ•¨}Â¨ checks} ğ•©) âŠ 1}
    {Râ—¶(transformsâˆ¾âŸ¨âŠ£âŸ©) ğ•©}
}

funs â† MapFnÂ¨ maps

Full â† {ğ•© {ğ•ğ•¨}{ğ•¨ğ”½ËœÂ´âŒ½ğ•©} funs}

âŒŠÂ´ FullÂ¨ borders


GenRange â† {ğ•Šğ•©:
    aâ€¿b â† ğ•©
    a + â†•b
}

