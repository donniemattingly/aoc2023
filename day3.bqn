s â† â€¢Import "strings.bqn"
ex â† â€¢FLines "input/ex3.in"
in â† â€¢FLines "input/3.in"

ListToMat â† {ğ•©:
    h â† â‰  ğ•©
    w â† âŒˆÂ´ â‰ Â¨ ğ•©
    hâ€¿w â¥Š âˆ¾Â´ğ•©
    }

Part1 â† {ğ•Šin:
    mat â† ListToMat in

digits â† (-âŸœ'0' mat)
nums â† digits âˆ§ (digits > 0)
test â† 3â€¿3â¥Š0â€¿0â€¿0â€¿0â€¿1â€¿0â€¿0â€¿0â€¿0 
IsSymbol â† {(ğ•© â‰  '.') âˆ§ ((ğ•© < '0') âˆ¨ ('9' < ğ•©))}
symbols â† IsSymbol mat

Up â† âˆ¨ âŸœ Â«
Down â† âˆ¨ âŸœ Â» 
Left â† âˆ¨ âŸœ Â«âŒ¾â‰ 
Right â† âˆ¨ âŸœ Â»âŒ¾â‰ 

((Up âˆ¨ Down) âˆ¨ (Left âˆ¨ Right)) test
symMask â† Up Left Down Right symbols
numMask â† nums > 0

nums â‹ˆÂ¨ numMask

a â† âŠ numMask

DecimalParts â† {ğ•Šğ•©:
    ğ•© âˆ§ 10âŠ¸â‹† 0âŠ¸âŒˆ Â¯1âŠ¸+ ({(ğ•© Ã— ğ•© + ğ•¨)}`âŒ¾âŒ½ ğ•©)
}

d â† nums Ã— DecimalPartsË˜ numMask

CalcVal â† {ğ•Šğ•©: {((ğ•© > 0) Ã— ğ•© + ğ•¨)}` ğ•©}
calced â† CalcValË˜ d

e â†  âŠ calced

GetVal â† {(ğ•© > 0) Ã— (ğ•¨ âŒˆ ğ•©)}`âŒ¾âŒ½
vals â† GetValË˜ calced
adjacentNumbers â† symMask âˆ§ vals 
+Â´ â· â¥Š symMask âˆ§ vals 

q â† 2 âŠ adjacentNumbers

DeDup â† {ğ•© Ã— ğ•© â‰  ğ•¨}`

+Â´ â· â¥Š DeDupË˜ adjacentNumbers
}