s â† â€¢Import "strings.bqn"
ex â† â€¢FLines "input/ex3.in"
in â† â€¢FLines "input/3.in"

ListToMat â† {ğ•©:
    h â† â‰  ğ•©
    w â† âŒˆÂ´ â‰ Â¨ ğ•©
    hâ€¿w â¥Š âˆ¾Â´ğ•©
    }

mat â† ListToMat ex

digits â† (-âŸœ'0' mat)
nums â† digits âˆ§ ((digits < 10)âˆ§(digits > 0))
IsSymbol â† {(ğ•© â‰  '.') âˆ§ ((ğ•© < '0') âˆ¨ ('9' < ğ•©))}
symbols â† IsSymbol mat

Up â† âˆ¨ âŸœ Â«
Down â† âˆ¨ âŸœ Â» 
Left â† âˆ¨ âŸœ Â«âŒ¾â‰ 
Right â† âˆ¨ âŸœ Â»âŒ¾â‰ 

((Up âˆ¨ Down) âˆ¨ (Left âˆ¨ Right)) test
symMask â† Up Left Down Right symbols
numMask â† nums > 0

nums â‹ˆÂ¨ numMask

a â† âŠ numMask

DecimalParts â† {ğ•Šğ•©:
    ğ•© âˆ§ 10âŠ¸â‹† 0âŠ¸âŒˆ Â¯1âŠ¸+ ({(ğ•© Ã— ğ•© + ğ•¨)}`âŒ¾âŒ½ ğ•©)
}

d â† nums Ã— DecimalPartsË˜ numMask

CalcVal â† {ğ•Šğ•©: {((ğ•© > 0) Ã— ğ•© + ğ•¨)}` ğ•©}
calced â† CalcValË˜ d

e â†  âŠ calced

GetVal â† {(ğ•© > 0) Ã— (ğ•¨ âŒˆ ğ•©)}`âŒ¾âŒ½
vals â† GetValË˜ calced
adjacentNumbers â† symMask âˆ§ vals 
+Â´ â· â¥Š symMask âˆ§ vals 

q â† 2 âŠ adjacentNumbers

# I think this is the issue, because it only removes the middle not the last digit

DeDup â† {ğ•© Ã— ğ•© â‰  ğ•¨}`

r â† DeDupË˜ adjacentNumbers

s â† (âˆŠË˜ r) âˆ§ r

# 551094

+Â´ â¥Š s

digitsâ†'0'+â†•10
nâ€¿mâ†â‰¢inputâ†>â€¢FLines"input/ex3.in"

symposâ†â‰>m(âŒŠâˆ˜Ã·Ëœâ‹ˆ|)/â¥ŠÂ¬inputâˆŠdigitsâˆ¾'.'
digposâ†(0â‰ â‰ )Â¨âŠ¸/ <Ë˜Â¨{+`1âŠ¸<|+Â´Ë˜+`â¼ğ•©}âŠ¸âŠ” â‰>m(âŒŠâˆ˜Ã·Ëœâ‹ˆ|)/â¥ŠinputâˆŠdigits
nearâ†{âˆ¨Â´â¥Š1âŠ¸=âŒˆÂ´Â¨|Â¨(<Ë˜sympos)-âŒœğ•©}Â¨digpos
numsâ†â€¢ParseFloatÂ¨âŠ‘âŸœinputÂ¨digpos
â€¢Show +Â´near/nums