s â† â€¢Import "strings.bqn"

ex â† â€¢FLines "input/ex4.in"
in â† â€¢FLines "input/4.in"

ParseCard â† {â€¢ParseFloatÂ¨Â¨ ((""âŠ¸â‰¢Â¨)âŠ¸ /)Â¨ (" "âŠ¸s.SplitÂ¨ âŠ‘ "|"âŠ¸s.SplitÂ¨ 1â†“":" s.Split ğ•©)}

ScoreCard â† {
    winningâ€¿card â† ParseCard ğ•© 
    2 â‹† 1 -Ëœ +Â´ winning âˆŠ card
}


Part1 â† {+Â´ âŒŠÂ¨ ScoreCardÂ¨ ğ•©}

â€¢Show Part1 in

Score2 â† {
    aâ€¿b â† ParseCard ğ•©
    +Â´ a âˆŠ b
}

ListToMat â† {ğ•©:
    h â† â‰  ğ•©
    w â† âŒˆÂ´ â‰ Â¨ ğ•©
    hâ€¿w â¥Š âˆ¾Â´ğ•©
    }

score â† Score2Â¨ in

# score â† 3â€¿0â€¿1â€¿0
c â† (â‰ score)â†‘Â¨1Ë™Â¨Â¨â†•Â¨score
dâ†(â†•â‰ c)
ShiftÂ¨ dâ‹ˆÂ¨c
Shift â† {F amtâ€¿vals: ((Â¯1 Ã— amt) - 1) âŒ½ vals}

f â† ShiftÂ¨ dâ‹ˆÂ¨c
mat â† ListToMat f
diag â† (=âŒœâ—‹â†•Â´)â‰¢mat

+Ë mat