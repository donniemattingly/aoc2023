s â† â€¢Import "strings.bqn"
u â† â€¢Import "utils.bqn"
ins â† â€¢FLinesÂ¨ "input/"âŠ¸âˆ¾Â¨ "ex11.in"â€¿"11.in"
exâ€¿in â† ins

Expand â† {(1 + âˆ§Â´Ë˜ '.'âŠ¸= ğ•©) / ğ•©}
mâ€¿n â† â‰¢ mat â† > ExpandâŒ¾â‰ Expand >ex
gc â† â‰ gsâ†â‰>n(âŒŠâˆ˜Ã·Ëœâ‹ˆ|)/â¥ŠmatâˆŠ"#"
â‰¢ distances â† (+Ë|âˆ˜-)â‰1â‰1â€¿âˆËœ gs
aa â† (<âŒœËœâ†•gc) âˆ§ distances
+Â´ 0âŠ¸<âŠ¸/ â¥Š aa

a â† 1â€¿1
b â† 4â€¿5
Mh â† (+Â´|âˆ˜-)
F â† {ğ•¨ğ•Šğ•©:
    aâ€¿b â† ğ•¨
    câ€¿d â† ğ•©

    xdiff â† d-b
    f â† b + (Ã—xdiff) Ã— â†•(1 + | xdiff)

    ydiff â† c-a
    e â† a + (Ã—ydiff) Ã—â†•(1 + | ydiff)

    e â‹ˆâŒœ f
}

# okay so I was pretty close, just making the wrong intermittent 
# points here if a/b is the larger of the two points, so just need to sort

y â† <Ë˜gs
perms â†  y â‹ˆâŒœ y

11â€¿5 F 1â€¿9

a Mh b
q â† 11â€¿5 F 1â€¿9

â‰  path â† <Ë˜ â· 1â†“(âŠ‘Ë˜ q) âˆ¾ (Â¯1 âŠ‘Ë˜ â‰ q)

â‰¢ mat

Er â† {9 Ã— âˆ§Â´Ë˜ '.'âŠ¸= ğ•©}
cost â† mat âˆŠ "#."
r â† Er mat
s â† Er â‰ mat

â‰¢ mat
sp â† s +Ë˜Ë˜âŒ¾â‰ cost
rp â† r +â‰0â€¿1 cost
actual â† rp âŒˆ sp

{ğ•© âŠ‘ actual}Â¨ path 

s â† âˆ§Â¨ â¥Š perms â†  y â‹ˆâŒœ y
paths â† â· >r â† (âˆ§Â´Â¨ âˆŠÂ¨ s) / s

G â† {ğ•Šğ•©: 
p1â€¿p2 â† x
p1 F p2
}

p1â€¿p2 â† âŠ paths
q â† {ğ•© âŠ‘ actual}Â¨ (p1 F p2)
path â† <Ë˜ â· 1â†“(âŠ‘Ë˜ q) âˆ¾ (Â¯1 âŠ‘Ë˜ â‰ q)